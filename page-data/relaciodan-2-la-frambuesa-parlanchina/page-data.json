{"componentChunkName":"component---src-templates-post-template-js","path":"/relaciodan-2-la-frambuesa-parlanchina/","result":{"data":{"markdownRemark":{"id":"35eaac7a-a387-5feb-b1d6-49ac37306fab","html":"<p>Esta es la segunda entrega de una serie de din√°micas de la <a href=\"https://instagram.com/escuela.relacional\" target=\"_blank\" rel=\"nofollow noopener noreferrer\">Escuela Relacional</a> en las que\nestoy participando. Ya est√° disponible <a href=\"https://zajdband.com/relaciodan-1-a-traves-del-algoritmo/\" target=\"_blank\" rel=\"nofollow noopener noreferrer\">el primer art√≠culo</a>.</p>\n<h2 id=\"parte-i-identidad\"><a href=\"#parte-i-identidad\" aria-label=\"parte i identidad permalink\" class=\"anchor\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Parte I: Identidad</h2>\n<p>La primera parte de la consigna, elegir un objeto que nos represente, puede parecer una pregunta de entrevista de trabajo\ncual ‚ÄúQu√© animal ser√≠as?‚Äú. Sin embargo, tomarnos un tiempo para pensar en esto puede ayudarnos a entender un poco m√°s\nsobre nosotros mismos.</p>\n<p>Despu√©s de pensarlo largamente y con ayuda de <a href=\"https://twitter.com/anamisbernal\" target=\"_blank\" rel=\"nofollow noopener noreferrer\">Ana</a> decid√≠ ir por un objeto que pasa\nla mayor parte del tiempo en un caj√≥n, m√°s precisamente en el que denominamos <strong>el caj√≥n de la tecnolog√≠a</strong>.</p>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto;  max-width: 800px;\"\n    >\n      <a\n    class=\"gatsby-resp-image-link\"\n    href=\"/static/c6bec33e87ef2bafc1f1bb6ab43a88bc/a296c/raspi.jpg\"\n    style=\"display: block\"\n    target=\"_blank\"\n    rel=\"noopener\"\n  >\n    <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 75.25%; position: relative; bottom: 0; left: 0; background-image: url('data:image/jpeg;base64,/9j/2wBDABALDA4MChAODQ4SERATGCgaGBYWGDEjJR0oOjM9PDkzODdASFxOQERXRTc4UG1RV19iZ2hnPk1xeXBkeFxlZ2P/2wBDARESEhgVGC8aGi9jQjhCY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2P/wgARCAAPABQDASIAAhEBAxEB/8QAFwABAQEBAAAAAAAAAAAAAAAABAABA//EABQBAQAAAAAAAAAAAAAAAAAAAAH/2gAMAwEAAhADEAAAAeomHB1kv//EABkQAAMBAQEAAAAAAAAAAAAAAAACAwERFP/aAAgBAQABBQK1tmeihJ9dLxZjIPhNOL//xAAUEQEAAAAAAAAAAAAAAAAAAAAQ/9oACAEDAQE/AT//xAAUEQEAAAAAAAAAAAAAAAAAAAAQ/9oACAECAQE/AT//xAAXEAEAAwAAAAAAAAAAAAAAAAAQARFC/9oACAEBAAY/Ai5Mn//EABkQAAIDAQAAAAAAAAAAAAAAAAERACExQf/aAAgBAQABPyF8lqyd6ralQG1CLBCbnSQ6IVRNvk//2gAMAwEAAgADAAAAEKgP/8QAFhEBAQEAAAAAAAAAAAAAAAAAAQBB/9oACAEDAQE/EEcgv//EABURAQEAAAAAAAAAAAAAAAAAAAAR/9oACAECAQE/EKr/xAAcEAEBAAICAwAAAAAAAAAAAAABEQBBUZEhMWH/2gAIAQEAAT8QQrpXw75yxCg6Y4ZEFKYZHqBadc4YlkGjH56yRQkumf/Z'); background-size: cover; display: block;\"\n  ></span>\n  <picture>\n        <source\n          srcset=\"/static/c6bec33e87ef2bafc1f1bb6ab43a88bc/01472/raspi.webp 240w,\n/static/c6bec33e87ef2bafc1f1bb6ab43a88bc/222bd/raspi.webp 480w,\n/static/c6bec33e87ef2bafc1f1bb6ab43a88bc/0cbce/raspi.webp 800w\"\n          sizes=\"(max-width: 800px) 100vw, 800px\"\n          type=\"image/webp\"\n        />\n        <source\n          srcset=\"/static/c6bec33e87ef2bafc1f1bb6ab43a88bc/3bc27/raspi.jpg 240w,\n/static/c6bec33e87ef2bafc1f1bb6ab43a88bc/98431/raspi.jpg 480w,\n/static/c6bec33e87ef2bafc1f1bb6ab43a88bc/a296c/raspi.jpg 800w\"\n          sizes=\"(max-width: 800px) 100vw, 800px\"\n          type=\"image/jpeg\"\n        />\n        <img\n          class=\"gatsby-resp-image-image\"\n          src=\"/static/c6bec33e87ef2bafc1f1bb6ab43a88bc/a296c/raspi.jpg\"\n          alt=\"Raspi\"\n          title=\"Raspi\"\n          loading=\"lazy\"\n        />\n      </picture>\n  </a>\n    </span></p>\n<p>El objeto en cuesti√≥n es una denominada <strong>Raspberry PI</strong>. La <a href=\"https://www.raspberrypi.org/\" target=\"_blank\" rel=\"nofollow noopener noreferrer\">Raspi</a> (para los amigos), es una computadora muy chiquita\nen tama√±o y muy barata (unos 30 d√≥lares) que fue inventada en el Reino Unido para ense√±ar inform√°tica en las escuelas.</p>\n<p>Por qu√© eleg√≠ este objeto? no porque me considere a mi mismo como una m√°quina ni mucho menos sino porque la Raspberry PI\nes usada mayoritariamente para experimentar y eso es lo que m√°s me gusta hacer con la tecnolog√≠a. Es muy simple convertir\nla Raspi en una consola de videojuegos, un centro multimedia, un servidor de aplicaciones web o lo que se nos ocurra.\nEsto me vino muy bien para la segunda parte de la din√°mica.</p>\n<h2 id=\"parte-ii-repetici√≥n\"><a href=\"#parte-ii-repetici%C3%B3n\" aria-label=\"parte ii repetici√≥n permalink\" class=\"anchor\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Parte II: Repetici√≥n</h2>\n<p>Luego de seleccionar el objeto se nos pidi√≥ que realicemos al menos 30 registros del objeto en distintos momentos. Ac√°\nes donde mi vagancia y falta de tiempo me vinieron al pelo y donde voy a empezar a mostrarles codiguito, no se preocupen.</p>\n<p>El concepto fue el siguiente:</p>\n<blockquote>\n<blockquote>\n<p>En vez de repetir el registro del objeto desde mi perspectiva intent√© que el objeto interact√∫e con la gente y as√≠\narmar el registro de repeticiones.</p>\n</blockquote>\n</blockquote>\n<h3 id=\"la-receta\"><a href=\"#la-receta\" aria-label=\"la receta permalink\" class=\"anchor\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>La receta</h3>\n<p>Para realizar la interacci√≥n entre mis compa√±eros y mi objeto se me ocurri√≥ lo siguiente:</p>\n<ul>\n<li>Levantar un sitio web que corra en la Raspberry.</li>\n<li>Al entrar al sitio el objeto cuenta cosas de si mismo, muestra interacciones pasadas e invita a participar en el registro colectivo.</li>\n<li>Si la persona accede se realiza el registro y se guarda en la memoria del objeto.</li>\n</ul>\n<h3 id=\"abriendo-el-coraz√≥n-de-la-red-de-mi-casa\"><a href=\"#abriendo-el-coraz%C3%B3n-de-la-red-de-mi-casa\" aria-label=\"abriendo el coraz√≥n de la red de mi casa permalink\" class=\"anchor\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Abriendo el coraz√≥n (de la red de mi casa)</h3>\n<p>Lo primero que hice fue <strong>quemar</strong> una imagen de <a href=\"https://www.raspberrypi.org/downloads/raspberry-pi-os/\" target=\"_blank\" rel=\"nofollow noopener noreferrer\">Raspbian</a> que es una\ndistribuci√≥n de Linux para Raspberry en una tarjeta SD y configurar el wifi con la red de mi casa para poder acceder sin\nconectarla a un monitor y teclado (ya dije que soy vago).</p>\n<p>Una vez conectada la Raspberry a la corriente con un cable para cargar el celu me conect√© por SSH a mi objeto elegido y me aboqu√©\na instalar todo para correr mi servidorcito web. Para eso me puse a instalar:</p>\n<ul>\n<li><strong>nginx</strong>: Para servir los requests.</li>\n<li><strong>Certbot</strong>: Maneja los certificados SSL.</li>\n<li><strong>node.js</strong>: Para el backend.</li>\n<li><strong>Cliente de <a href=\"https://www.noip.com/\" target=\"_blank\" rel=\"nofollow noopener noreferrer\">noip</a></strong>: Para rutear los DNS hacia la IP del router de mi casa que no es est√°tica.</li>\n</ul>\n<p>Una vez configurado todo este ambiente (me pueden <a href=\"https://twitter.com/impronunciable\" target=\"_blank\" rel=\"nofollow noopener noreferrer\">escribir</a> si necesitan una mano haciendo esto)\ny emocionado porque los pedidos a mi p√°gina entraban directo a la maquinita que ten√≠a a mi lado me puse a armar el sitio propiamente dicho.</p>\n<h3 id=\"la-experiencia-de-humano\"><a href=\"#la-experiencia-de-humano\" aria-label=\"la experiencia de humano permalink\" class=\"anchor\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>La experiencia de humano</h3>\n<p>Como dije antes, la idea era que la gente que entrara al sitio se llevara un poco del objeto y dejara su sensaci√≥n registrada.\nPor eso cuando se entraba al sitio (que ya no anda porque no da tener la raspi corriendo todo el d√≠a y mi router expuesto al COVID-19)\nse ve√≠a algo as√≠:</p>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto;  max-width: 960px;\"\n    >\n      <a\n    class=\"gatsby-resp-image-link\"\n    href=\"/static/f5a3ca7789155feef9c5f2a59d22699a/c7123/raspi-site.jpg\"\n    style=\"display: block\"\n    target=\"_blank\"\n    rel=\"noopener\"\n  >\n    <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 90.69767441860465%; position: relative; bottom: 0; left: 0; background-image: url('data:image/jpeg;base64,/9j/2wBDABALDA4MChAODQ4SERATGCgaGBYWGDEjJR0oOjM9PDkzODdASFxOQERXRTc4UG1RV19iZ2hnPk1xeXBkeFxlZ2P/2wBDARESEhgVGC8aGi9jQjhCY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2P/wgARCAASABQDASIAAhEBAxEB/8QAGAABAAMBAAAAAAAAAAAAAAAAAAECAwX/xAAVAQEBAAAAAAAAAAAAAAAAAAAAAf/aAAwDAQACEAMQAAAB6epGyBTQJB//xAAcEAABAwUAAAAAAAAAAAAAAAADAAIRARITIDH/2gAIAQEAAQUCKXEhuvaq9mNf/8QAFBEBAAAAAAAAAAAAAAAAAAAAIP/aAAgBAwEBPwEf/8QAFBEBAAAAAAAAAAAAAAAAAAAAIP/aAAgBAgEBPwEf/8QAGhAAAgIDAAAAAAAAAAAAAAAAABEBIRAgMf/aAAgBAQAGPwK2PHCo1//EABsQAQACAwEBAAAAAAAAAAAAAAEAERAhMVFx/9oACAEBAAE/IS2Cvya7Z9xVV2hwog2dj1gax//aAAwDAQACAAMAAAAQ6yeC/8QAFBEBAAAAAAAAAAAAAAAAAAAAIP/aAAgBAwEBPxAf/8QAFBEBAAAAAAAAAAAAAAAAAAAAIP/aAAgBAgEBPxAf/8QAGxABAAMBAQEBAAAAAAAAAAAAAQARMSFRQZH/2gAIAQEAAT8Q5iVQe5SkbVHTAfbhADvVIxoi8ElS/UP7QKcMmZP/2Q=='); background-size: cover; display: block;\"\n  ></span>\n  <picture>\n        <source\n          srcset=\"/static/f5a3ca7789155feef9c5f2a59d22699a/01472/raspi-site.webp 240w,\n/static/f5a3ca7789155feef9c5f2a59d22699a/222bd/raspi-site.webp 480w,\n/static/f5a3ca7789155feef9c5f2a59d22699a/620b9/raspi-site.webp 960w,\n/static/f5a3ca7789155feef9c5f2a59d22699a/6f615/raspi-site.webp 1204w\"\n          sizes=\"(max-width: 960px) 100vw, 960px\"\n          type=\"image/webp\"\n        />\n        <source\n          srcset=\"/static/f5a3ca7789155feef9c5f2a59d22699a/3bc27/raspi-site.jpg 240w,\n/static/f5a3ca7789155feef9c5f2a59d22699a/98431/raspi-site.jpg 480w,\n/static/f5a3ca7789155feef9c5f2a59d22699a/b3ee8/raspi-site.jpg 960w,\n/static/f5a3ca7789155feef9c5f2a59d22699a/c7123/raspi-site.jpg 1204w\"\n          sizes=\"(max-width: 960px) 100vw, 960px\"\n          type=\"image/jpeg\"\n        />\n        <img\n          class=\"gatsby-resp-image-image\"\n          src=\"/static/f5a3ca7789155feef9c5f2a59d22699a/b3ee8/raspi-site.jpg\"\n          alt=\"Sitio en la Raspi\"\n          title=\"Sitio en la Raspi\"\n          loading=\"lazy\"\n        />\n      </picture>\n  </a>\n    </span></p>\n<p>En la introducci√≥n el objeto se presenta no solo contando su historia sino con 2 datos de su presente. Por un lado\ncuenta hace cuanto est√° despierto y por otro su temperatura actual.</p>\n<p>Como coment√© us√© node.js para este ejercicio. Para obtener el tiempo de vigilia us√© <code class=\"language-text\">process.uptime()</code> que retorna\nla cantidad de segundos desde que el proceso se despert√≥. Para mostrar algo m√°s natural que una cantidad en segundos\nus√© <code class=\"language-text\">date-fns</code> para que me de el tiempo relativo. Para la temperatura us√© el m√≥dulo <code class=\"language-text\">pi-temperature</code> que creo no\nrequiere mucha explicaci√≥n. Fue interesante recibir comentarios sobre la ‚Äúalta temperatura‚Äù de la Raspi, creo que esto\nayud√≥ a darle un car√°cter subjetivo al objeto.</p>\n<p>Despu√©s de la selfie se muestra un listado de registros. Como se puede ver, cada registro cuenta con 2 datos: La localizaci√≥n\nrelative de la persona que entr√≥ al sitio respecto a la ubicaci√≥n de casa y por otro lado el estado <strong>emocional</strong> de la persona\ncapturado por el objeto.</p>\n<p>M√°s abajo aparece la s√∫plica de colaboraci√≥n para participar del registro. Vamos a ver como se capturaron los registros que es lo que\nprobablemente te interese ahora.</p>\n<h3 id=\"atr√°palos-ya\"><a href=\"#atr%C3%A1palos-ya\" aria-label=\"atr√°palos ya permalink\" class=\"anchor\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Atr√°palos ya!</h3>\n<p>Al clickear en el bot√≥n se registraban 2 datapoints: Distancia y emoci√≥n.</p>\n<h4 id=\"calculando-la-distancia\"><a href=\"#calculando-la-distancia\" aria-label=\"calculando la distancia permalink\" class=\"anchor\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Calculando la distancia</h4>\n<p>Para esto us√© al querido objeto <code class=\"language-text\">navigator.geolocation</code>. El c√≥digo para esto es bien simple:</p>\n<div class=\"gatsby-highlight\" data-language=\"javascript\"><pre class=\"language-javascript\"><code class=\"language-javascript\">navigator<span class=\"token punctuation\">.</span>geolocation<span class=\"token punctuation\">.</span><span class=\"token function\">getCurrentPosition</span><span class=\"token punctuation\">(</span><span class=\"token keyword\">function</span><span class=\"token punctuation\">(</span><span class=\"token parameter\">position</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n  <span class=\"token keyword\">const</span> posicion <span class=\"token operator\">=</span> <span class=\"token punctuation\">{</span> lat<span class=\"token punctuation\">:</span> position<span class=\"token punctuation\">.</span>coords<span class=\"token punctuation\">.</span>latitude<span class=\"token punctuation\">,</span> lon<span class=\"token punctuation\">:</span> position<span class=\"token punctuation\">.</span>coords<span class=\"token punctuation\">.</span>longitude <span class=\"token punctuation\">}</span><span class=\"token punctuation\">;</span>\n<span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></code></pre></div>\n<p>Como no me interesaba por privacidad ni por objetivo del ejercicio guardar la ubicaci√≥n real de la persona sino la distancia a mi casa,\nel servidor simplemente guardaba la distancia ente mi ubicaci√≥n y ese punto. Us√© el m√≥dulo <code class=\"language-text\">geo-distance</code> por vago pero una distancia\neuclideana bastaba. Lo bueno de este m√≥dulo es que tiene funcionces que escupen el resultado en lenguaje natural.</p>\n<div class=\"gatsby-highlight\" data-language=\"javascript\"><pre class=\"language-javascript\"><code class=\"language-javascript\"><span class=\"token keyword\">const</span> Distance <span class=\"token operator\">=</span> <span class=\"token function\">require</span><span class=\"token punctuation\">(</span><span class=\"token string\">'geo-distance'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token keyword\">function</span> <span class=\"token function\">getDistance</span><span class=\"token punctuation\">(</span><span class=\"token parameter\">position</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n  <span class=\"token keyword\">const</span> dis <span class=\"token operator\">=</span> Distance<span class=\"token punctuation\">.</span><span class=\"token function\">between</span><span class=\"token punctuation\">(</span>home<span class=\"token punctuation\">,</span> position<span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span><span class=\"token function\">human_readable</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span><span class=\"token function\">toString</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n  <span class=\"token keyword\">return</span> <span class=\"token template-string\"><span class=\"token template-punctuation string\">`</span><span class=\"token string\">Desde </span><span class=\"token interpolation\"><span class=\"token interpolation-punctuation punctuation\">${</span>dis<span class=\"token interpolation-punctuation punctuation\">}</span></span><span class=\"token string\"> de mi casa</span><span class=\"token template-punctuation string\">`</span></span><span class=\"token punctuation\">;</span>\n<span class=\"token punctuation\">}</span></code></pre></div>\n<h4 id=\"algo-en-tu-cara-me-fascina\"><a href=\"#algo-en-tu-cara-me-fascina\" aria-label=\"algo en tu cara me fascina permalink\" class=\"anchor\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Algo en tu cara me fascina</h4>\n<p>Como dijo Elvis Crespo algo en tu cara me da vida, ser√° tu sonrisa? Esa es la pregunta que quer√≠a que se haga la Raspi\ny no quer√≠a correr un algoritmo muy pesado en el server.</p>\n<p>Lo que hice fue usar <a href=\"https://github.com/justadudewhohacks/face-api.js\" target=\"_blank\" rel=\"nofollow noopener noreferrer\">Face API</a> un modelo para <a href=\"https://www.tensorflow.org/js\" target=\"_blank\" rel=\"nofollow noopener noreferrer\">Tensorflow JS</a>\nque nos permite ejecutar modelos de DeepLearning en el navegador ü§Ø.</p>\n<p>Cuando la persona clickeaba en el bot√≥n, adem√°s de pedir permiso de geolocation tambi√©n ped√≠a permiso de acceso a la webcam\ny usaba el algoritmo mirando la imagen hasta identificar una emoci√≥n.</p>\n<p>El flujo para identificar la emoci√≥n en la cara del registrado es algo como esto (hay un poco m√°s de c√≥digo que met√≠ para evitar\nrace conditions pero no viene al caso):</p>\n<div class=\"gatsby-highlight\" data-language=\"javascript\"><pre class=\"language-javascript\"><code class=\"language-javascript\">  <span class=\"token comment\">// Pido acceso al video y empiezo a \"leer\" las im√°genes</span>\n  <span class=\"token keyword\">const</span> videoElement <span class=\"token operator\">=</span> document<span class=\"token punctuation\">.</span><span class=\"token function\">createElement</span><span class=\"token punctuation\">(</span><span class=\"token string\">'video'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n  document<span class=\"token punctuation\">.</span>body<span class=\"token punctuation\">.</span><span class=\"token function\">appendChild</span><span class=\"token punctuation\">(</span>videoElement<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\n  <span class=\"token keyword\">return</span> navigator<span class=\"token punctuation\">.</span>mediaDevices<span class=\"token punctuation\">.</span><span class=\"token function\">getUserMedia</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">{</span> video<span class=\"token punctuation\">:</span> <span class=\"token punctuation\">{</span> facingMode<span class=\"token punctuation\">:</span><span class=\"token string\">'user'</span> <span class=\"token punctuation\">}</span> <span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span>\n  <span class=\"token punctuation\">.</span><span class=\"token function\">then</span><span class=\"token punctuation\">(</span><span class=\"token parameter\">capture</span> <span class=\"token operator\">=></span> <span class=\"token punctuation\">{</span>\n    videoElement<span class=\"token punctuation\">.</span>srcObject <span class=\"token operator\">=</span> capture<span class=\"token punctuation\">;</span>\n    videoElement<span class=\"token punctuation\">.</span><span class=\"token function\">play</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n  <span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\n  <span class=\"token comment\">// Cargo los modelos</span>\n  Promise<span class=\"token punctuation\">.</span><span class=\"token function\">all</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">[</span>\n    faceapi<span class=\"token punctuation\">.</span>nets<span class=\"token punctuation\">.</span>faceExpressionNet<span class=\"token punctuation\">.</span><span class=\"token function\">loadFromUri</span><span class=\"token punctuation\">(</span><span class=\"token string\">'/models'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span>\n    faceapi<span class=\"token punctuation\">.</span>nets<span class=\"token punctuation\">.</span>ssdMobilenetv1<span class=\"token punctuation\">.</span><span class=\"token function\">loadFromUri</span><span class=\"token punctuation\">(</span><span class=\"token string\">'/models'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span>\n  <span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span><span class=\"token function\">then</span><span class=\"token punctuation\">(</span>detectFaces<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\n  <span class=\"token comment\">// Detecto emociones</span>\n  <span class=\"token keyword\">function</span> <span class=\"token function\">detectarEmocion</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n    <span class=\"token comment\">// Cada 1 segundo tomo una foto</span>\n    <span class=\"token keyword\">const</span> inter <span class=\"token operator\">=</span> <span class=\"token function\">setInterval</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">=></span> <span class=\"token punctuation\">{</span>\n      faceapi<span class=\"token punctuation\">.</span><span class=\"token function\">detectSingleFace</span><span class=\"token punctuation\">(</span>videoElement<span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span><span class=\"token function\">withFaceExpressions</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span>\n      <span class=\"token punctuation\">.</span><span class=\"token function\">then</span><span class=\"token punctuation\">(</span><span class=\"token parameter\">res</span> <span class=\"token operator\">=></span> <span class=\"token punctuation\">{</span>\n        <span class=\"token comment\">// Ordeno las expresiones por nivel de confianza del algoritmo y elijo la primera</span>\n        <span class=\"token keyword\">const</span> <span class=\"token punctuation\">[</span>emocion<span class=\"token punctuation\">,</span> confianza<span class=\"token punctuation\">]</span> <span class=\"token operator\">=</span> Object<span class=\"token punctuation\">.</span><span class=\"token function\">entries</span><span class=\"token punctuation\">(</span>res<span class=\"token punctuation\">.</span>expressions<span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span><span class=\"token function\">sort</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">(</span><span class=\"token parameter\">a<span class=\"token punctuation\">,</span> b</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">=></span> b<span class=\"token punctuation\">[</span><span class=\"token number\">1</span><span class=\"token punctuation\">]</span> <span class=\"token operator\">-</span> a<span class=\"token punctuation\">[</span><span class=\"token number\">1</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">[</span><span class=\"token number\">0</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">;</span>\n        <span class=\"token comment\">// Si la confianza es m√°s del 50% la env√≠o y dejo de detectar</span>\n        <span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span>confianza <span class=\"token operator\">>=</span> <span class=\"token number\">0.5</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n          <span class=\"token function\">clearInterval</span><span class=\"token punctuation\">(</span>inter<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n          <span class=\"token function\">sendData</span><span class=\"token punctuation\">(</span>emocion<span class=\"token punctuation\">,</span> confianza<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n        <span class=\"token punctuation\">}</span>\n      <span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n    <span class=\"token punctuation\">}</span><span class=\"token punctuation\">,</span> <span class=\"token number\">1000</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n  <span class=\"token punctuation\">}</span></code></pre></div>\n<p>Una vez enviada la informaci√≥n al servidor, en vez de hablar de porcentaje de confianza lo pongo en t√©rminos m√°s naturales\ny hago la traducci√≥n al espa√±ol con una funci√≥n simple:</p>\n<div class=\"gatsby-highlight\" data-language=\"javascript\"><pre class=\"language-javascript\"><code class=\"language-javascript\"><span class=\"token keyword\">var</span> expressions <span class=\"token operator\">=</span> <span class=\"token punctuation\">{</span>\n  neutral<span class=\"token punctuation\">:</span> <span class=\"token string\">'tranquile'</span><span class=\"token punctuation\">,</span>\n  happy<span class=\"token punctuation\">:</span> <span class=\"token string\">'alegre'</span><span class=\"token punctuation\">,</span> \n  sad<span class=\"token punctuation\">:</span> <span class=\"token string\">'triste'</span><span class=\"token punctuation\">,</span>\n  angry<span class=\"token punctuation\">:</span> <span class=\"token string\">'enojade'</span><span class=\"token punctuation\">,</span> \n  fearful<span class=\"token punctuation\">:</span> <span class=\"token string\">'miedose'</span><span class=\"token punctuation\">,</span>\n  disgusted<span class=\"token punctuation\">:</span> <span class=\"token string\">'a disgusto'</span><span class=\"token punctuation\">,</span>\n  surprised<span class=\"token punctuation\">:</span> <span class=\"token string\">'sorprendido'</span>\n\n<span class=\"token punctuation\">}</span>\n\n<span class=\"token keyword\">function</span> <span class=\"token function\">getExpression</span> <span class=\"token punctuation\">(</span><span class=\"token parameter\">exp</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n  <span class=\"token keyword\">var</span> adj <span class=\"token operator\">=</span> <span class=\"token string\">'un poco'</span>\n  <span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span>exp<span class=\"token punctuation\">.</span>value <span class=\"token operator\">></span> <span class=\"token number\">0.75</span><span class=\"token punctuation\">)</span> adj <span class=\"token operator\">=</span> <span class=\"token string\">'bastante'</span>\n  <span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span>exp<span class=\"token punctuation\">.</span>value <span class=\"token operator\">></span> <span class=\"token number\">0.9</span><span class=\"token punctuation\">)</span> adj <span class=\"token operator\">=</span> <span class=\"token string\">'demasiado'</span> \n  <span class=\"token keyword\">return</span> <span class=\"token template-string\"><span class=\"token template-punctuation string\">`</span><span class=\"token interpolation\"><span class=\"token interpolation-punctuation punctuation\">${</span>adj<span class=\"token interpolation-punctuation punctuation\">}</span></span><span class=\"token string\"> </span><span class=\"token interpolation\"><span class=\"token interpolation-punctuation punctuation\">${</span>expressions<span class=\"token punctuation\">[</span>exp<span class=\"token punctuation\">.</span>name<span class=\"token punctuation\">]</span> <span class=\"token operator\">||</span> <span class=\"token string\">'tranquilo'</span><span class=\"token interpolation-punctuation punctuation\">}</span></span><span class=\"token template-punctuation string\">`</span></span>\n<span class=\"token punctuation\">}</span></code></pre></div>\n<p>Luego se guardan los datos en la base (un archivo JSON) para que el pr√≥ximo\nparticipante pueda leer los √∫ltimos 5 y as√≠ tambi√©n armar mi base de datos de\nrepeticiones no tan repetidas.</p>\n<h3 id=\"no-tan-r√°pido\"><a href=\"#no-tan-r%C3%A1pido\" aria-label=\"no tan r√°pido permalink\" class=\"anchor\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>No tan r√°pido</h3>\n<p>Esta fue la segunda entrega de esta serie de ejercicios que estamos haciendo en la\n<a href=\"https://instagram.com/escuela.relacional\" target=\"_blank\" rel=\"nofollow noopener noreferrer\">Escuela Relacional</a> ‚ù§Ô∏è. Mis agradecimientos a\nla gente hermosa que la compone y me permite ser parte de esto.</p>","fields":{"slug":"/relaciodan-2-la-frambuesa-parlanchina/","tagSlugs":["/tag/relaciodan/","/tag/raspberry-pi/","/tag/tensorflow/"]},"frontmatter":{"date":"2020-06-06T16:23:35-05:00","description":"La primera parte de la consigna, elegir un objeto que nos represente, puede parecer una pregunta de entrevista de trabajo cual `Qu√© animal ser√≠as?`. Sin embargo, tomarnos un tiempo para pensar en esto puede ayudarnos a entender un poco m√°s sobre nosotros mismos.","tags":["relaciodan","raspberry pi","tensorflow"],"title":"Relaciodan #2: La frambuesa parlanchina","socialImage":"/photo.jpg"}}},"pageContext":{"isCreatedByStatefulCreatePages":false,"slug":"/relaciodan-2-la-frambuesa-parlanchina/"}}}